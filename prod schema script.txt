create TABLE CUSTOMER_DIM (
	CUSTOMERID NUMBER(38,0),
	FIRST_NAME VARCHAR(255),
	LAST_NAME VARCHAR(255),
	EMAIL VARCHAR(255),
	CUSTCITY VARCHAR(100),
	CUSTSTATE VARCHAR(50),
	CUSTZIP VARCHAR(50),
	primary key (CUSTOMERID));

create TABLE PRODUCT_DIM (
    PRODUCTID NUMBER(38,0),
	BRAND VARCHAR(200),
	NAME VARCHAR(1000),
	DESCRIPTION VARCHAR(5000),
	PRICE NUMBER(10,2),
	MSRP NUMBER(10,2),
	COST NUMBER(10,2),
	DISCOUNTRATE NUMBER(10,2),
	MARKUPPERCENTAGE NUMBER(10,2),
	primary key (PRODUCTID));

create TABLE SALES_FACT (
	ORDERID NUMBER(38,0),
	ORDERAMT NUMBER(12,2),
	ORDERQTY NUMBER(38,0),
	CUSTOMERID NUMBER(38,0),
	ORDERDT_YEAR NUMBER(38,0),
	ORDERDT_DAY NUMBER(38,0),
	ORDERDT_TIME TIME(9),
	ORDERDT_AM_PM VARCHAR(4),
	TOTAL_SALES DECIMAL(10,2),
	ORDERDT_MONTH_NAME VARCHAR(20),
	primary key (ORDERID),
	foreign key (CUSTOMERID) references CUSTOMER_DIM(CUSTOMERID));

create TABLE ORDERDETAIL_DIM (
	ORDERDETAILID NUMBER(38,0),
	PRODUCTID NUMBER(38,0),
	ORDERID NUMBER(38,0),
	primary key (ORDERDETAILID),
	foreign key (PRODUCTID) references PRODUCT_DIM(PRODUCTID),
	foreign key (ORDERID) references SALES_FACT(ORDERID));


INSERT INTO PROD_SCHEMA.Customer_Dim (CustomerID, First_Name, Last_Name, Email, CustCity, CustState, CustZip)
SELECT CustomerID, First_Name, Last_Name, Email, CustCity, CustState, CustZip
FROM STAGE_DATA.Customer_Dim;

INSERT INTO PROD_SCHEMA.PRODUCT_DIM (PRODUCTID, BRAND, NAME, DESCRIPTION, PRICE, MSRP, COST, DISCOUNTRATE, MARKUPPERCENTAGE)
SELECT PRODUCTID, BRAND, NAME, DESCRIPTION, PRICE, MSRP, COST, DISCOUNTRATE, MARKUPPERCENTAGE FROM STAGE_DATA.PRODUCT_DIM;

INSERT INTO PROD_SCHEMA.SALES_FACT (ORDERID, ORDERAMT, ORDERQTY, CUSTOMERID,ORDERDT_YEAR,ORDERDT_DAY, ORDERDT_TIME, ORDERDT_AM_PM, TOTAL_SALES, ORDERDT_MONTH_NAME) 
SELECT ORDERID, ORDERAMT, ORDERQTY, CUSTOMERID,ORDERDT_YEAR,ORDERDT_DAY, ORDERDT_TIME, ORDERDT_AM_PM, TOTAL_SALES, ORDERDT_MONTH_NAME FROM STAGE_DATA.SALES_FACT;

INSERT INTO PROD_SCHEMA.ORDERDETAIL_DIM (ORDERDETAILID, PRODUCTID, ORDERID)
SELECT ORDERDETAILID, PRODUCTID, ORDERID FROM STAGE_DATA.ORDERDETAIL_DIM;
